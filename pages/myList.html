<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Lemon&family=Libre+Baskerville:wght@400;700&family=Montserrat:wght@200;300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="shortcut icon"
      href="https://krisnasantosa15.github.io/sineflix/favicon/favicon.ico"
      type="image/x-icon"
    />
    <link
      rel="stylesheet"
      href="https://krisnasantosa15.github.io/sineflix/css/owl.carousel.min.css"
    />
    <link
      rel="stylesheet"
      href="https://krisnasantosa15.github.io/sineflix/css/owl.theme.default.min.css"
    />
    <link
      rel="stylesheet"
      href="https://krisnasantosa15.github.io/sineflix/fontawesome/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://krisnasantosa15.github.io/sineflix/css/swiper-bundle.min.css"
    />
    <link
      rel="stylesheet"
      href="https://krisnasantosa15.github.io/sineflix/css/style.css"
    />
    <title>SineFlick</title>
  </head>
  <body>
    <!-- Navbar -->
    <div class="container">
      <header class="header">
        <div class="header-logo-container">
          <img
            src="https://krisnasantosa15.github.io/sineflix/img/logo/logo-transparent.png"
            class="header-logo"
            alt="SineFlick"
          />
        </div>
        <nav class="navBar">
          <div class="open-btn" id="open">
            <i class="fa-solid fa-bars"></i>
          </div>
          <div class="nav-items">
            <ul class="list">
              <li>
                <a href="https://krisnasantosa15.github.io/sineflix/index.html"
                  >Home</a
                >
              </li>
              <li>
                <a
                  href="https://krisnasantosa15.github.io/sineflix/pages/movies.html"
                  >Movies</a
                >
              </li>
              <li>
                <a
                  href="https://krisnasantosa15.github.io/sineflix/pages/tvSeries.html"
                  >TV Series</a
                >
              </li>
              <li>
                <a
                  href="https://krisnasantosa15.github.io/sineflix/pages/animatedMovies.html"
                  >Animated Movies</a
                >
              </li>
              <li>
                <a
                  href="https://krisnasantosa15.github.io/sineflix/pages/myList.html"
                  >My List</a
                >
              </li>
              <div class="close-btn" id="close">
                <i class="fa-solid fa-xmark"></i>
              </div>
            </ul>
            <div>
              <ul class="user">
                <li>
                  <i
                    class="fa-solid fa-magnifying-glass"
                    onclick="openSearch()"
                  ></i>
                </li>
                <ul class="auth-btn">
                  <li>
                    <a
                      href="https://krisnasantosa15.github.io/sineflix/pages/signup.html"
                      class="btn-2"
                      >Signup</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://krisnasantosa15.github.io/sineflix/pages/login.html"
                      class="btn-1"
                      >Login</a
                    >
                  </li>
                </ul>
              </ul>
            </div>
          </div>
          <div id="myOverlay" class="overlay">
            <span class="closebtn" onclick="closeSearch()" title="Close Overlay"
              >Ã—</span
            >
            <div class="overlay-content">
              <form
                action="https://krisnasantosa15.github.io/sineflix/pages/searchMovie.html"
                method="get"
              >
                <input
                  type="text"
                  name="query"
                  id="searchInput"
                  placeholder="Search.."
                  onkeyup="getSearchSuggestions(this.value)"
                />
                <div id="searchSuggestions"></div>
                <button
                  type="submit"
                  class="btn-1 search-button"
                  style="border-radius: 0; height: auto"
                >
                  <i class="fa fa-search"></i>
                </button>
              </form>
            </div>
          </div>
        </nav>
      </header>
    </div>

    <!-- Slider Hero Section -->
    <div class="swiper mySwiper">
      <div class="swiper-wrapper" id="heroSection"></div>
    </div>

    <div class="movies">
      <div class="movies-title">
        <h1>My List</h1>
      </div>
      <div class="movies-ctg">
        <div class="ctg-1" id="genreButtons"></div>
      </div>

      <div class="movies-card" id="movieContainer"></div>
    </div>

    <footer id="footer">
      <div class="footer-container">
        <div>
          <img
            src="https://krisnasantosa15.github.io/sineflix/img/logo/logo-text.png"
            class="footer-logo"
            alt="SineFlick logo"
          />
          <p class="footer-text">
            we provide the latest movies and TV shows for you, enjoy scrolling
          </p>
          <div class="contact-info">
            <h3 class="footer-title">Contact Info</h3>
            <ul class="footer-link">
              <li>
                <i class="fa fa-map-marker-alt"></i>
                <span>Cibiru, Bandung</span>
              </li>
              <li>
                <i class="fa fa-phone-alt"></i>
                <span>+123-456-7890</span>
              </li>
            </ul>
          </div>
        </div>
        <div>
          <h3 class="footer-title">Useful Links</h3>
          <ul class="footer-link">
            <li>
              <a href="https://krisnasantosa15.github.io/sineflix/index.html"
                >> Home</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/movies.html"
                >> Movies</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/myList.html"
                >> My List</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/contactUs.html"
                >> Contact Us</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/about.html"
                >> About</a
              >
            </li>
          </ul>
        </div>
        <div>
          <h3 class="footer-title">Our Services</h3>
          <ul class="footer-link">
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/services.html"
                >Latest Movies</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/services.html"
                >24 Hours Services</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/services.html"
                >Free Access</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/services.html"
                >Access TV show</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/services.html"
                >Condition of Use</a
              >
            </li>
          </ul>
        </div>
        <div>
          <h3 class="footer-title">Categories</h3>
          <ul class="footer-link">
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/categories.html#action"
                >> Action</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/categories.html#comedy"
                >> Comedy</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/categories.html#crime"
                >> Crime</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/categories.html#sciFi"
                >> Sci-Fi</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/categories.html#thriller"
                >> Thriller</a
              >
            </li>
          </ul>
        </div>
        <div>
          <h3 class="footer-title">Support for you</h3>
          <ul class="footer-link">
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/help.html"
                >Help Center</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/support.html"
                >Support</a
              >
            </li>
            <li>
              <a
                href="https://krisnasantosa15.github.io/sineflix/pages/faq.html"
                >FAQ & Terms</a
              >
            </li>
          </ul>
        </div>
      </div>
    </footer>

    <script src="https://krisnasantosa15.github.io/sineflix/js/jquery-3.7.1.js"></script>
    <script src="https://krisnasantosa15.github.io/sineflix/js/owl.carousel.min.js"></script>
    <script src="https://krisnasantosa15.github.io/sineflix/js/swiper-bundle.min.js"></script>
    <script>
      // My List from localStorage
      const myList = JSON.parse(localStorage.getItem("myList")) || [];
      window.onscroll = function () {
        const header = document.querySelector("header");
        const fixedNav = header.offsetTop;
        // const toTop = document.querySelector("#to-top");

        if (window.pageYOffset > fixedNav) {
          // header.classList.add("navbar-fixed");
          header.style.position = "fixed";
        } else {
          // header.classList.remove("navbar-fixed");
          header.style.position = "relative";
        }
      };

      let swiper = new Swiper(".mySwiper", {
        slidesPerView: 1,
        spaceBetween: 30,
        loop: true,
        pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
        navigation: {
          nextEl: ".swiper-button-next",
          prevEl: ".swiper-button-prev",
        },
      });

      const nav = document.querySelector(".nav-items");
      const open = document.getElementById("open");
      const close = document.getElementById("close");

      open.addEventListener("click", () => {
        nav.style.display = "flex";
        nav.style.top = "0%";
      });
      close.addEventListener("click", () => {
        nav.style.top = "-110vh";
      });

      function openSearch() {
        document.getElementById("myOverlay").style.display = "block";
      }

      function closeSearch() {
        document.getElementById("myOverlay").style.display = "none";
      }

      async function getSearchSuggestions(keyword) {
        const response = await fetch(
          "https://krisnasantosa15.github.io/sineflix/js/data/data.json"
        );
        const data = await response.json();
        const movies = data.items;

        const searchSuggestions = document.getElementById("searchSuggestions");
        searchSuggestions.innerHTML = "";

        if (keyword.trim() !== "") {
          const filteredMovies = movies.filter((movie) =>
            movie.title.toLowerCase().includes(keyword.toLowerCase())
          );
          filteredMovies.forEach((movie) => {
            const link = document.createElement("a");
            link.textContent = `${movie.title} - ${movie.type}`;
            link.href = `/pages/detailFilm.html?id=${movie.id}`;

            const suggestionElement = document.createElement("div");
            suggestionElement.addEventListener("click", () => {
              document.querySelector("input[name='search']").value =
                movie.title;
              searchSuggestions.innerHTML = "";
            });
            suggestionElement.appendChild(link);
            searchSuggestions.appendChild(suggestionElement);
          });
        }
      }
      document.addEventListener("DOMContentLoaded", function () {
        let selectedGenres = [];

        fetchMovies();

        function fetchMovies() {
          fetch("https://krisnasantosa15.github.io/sineflix/js/data/data.json")
            .then((response) => response.json())
            .then((data) => {
              generateGenreButtons();

              const myMovies = data.items.filter((movie) =>
                myList.includes(movie.id)
              );

              generateMovieCards(myMovies);
            })
            .catch((error) => console.error("Error fetching movies:", error));
        }

        function generateGenreButtons() {
          const genres = [
            "Action",
            "Adventure",
            "Biography",
            "Crime",
            "Comedy",
            "Drama",
            "Fantasy",
            "Historical",
            "Horror",
            "Musical",
            "Sci-Fi",
            "Sport",
            "Thriller",
          ];

          const genreButtonsContainer = document.getElementById("genreButtons");

          genres.forEach((genre) => {
            const button = document.createElement("button");
            button.textContent = genre;
            button.classList.add("btn");
            button.classList.add("genre-button");
            button.addEventListener("click", () =>
              toggleGenreFilter(genre, button)
            );
            genreButtonsContainer.appendChild(button);
          });
        }

        function toggleGenreFilter(genre, button) {
          const index = selectedGenres.indexOf(genre);
          if (index === -1) {
            selectedGenres.push(genre);
            button.classList.add("active");
          } else {
            selectedGenres.splice(index, 1);
            button.classList.remove("active");
          }
          filterMovies();
        }

        function filterMovies() {
          fetch("https://krisnasantosa15.github.io/sineflix/js/data/data.json")
            .then((response) => response.json())
            .then((data) => {
              let filteredMovies = data.items.filter((movie) =>
                myList.includes(movie.id)
              );
              if (selectedGenres.length > 0) {
                filteredMovies = filteredMovies.filter((movie) => {
                  return selectedGenres.every((genre) =>
                    movie.genre.includes(genre)
                  );
                });
              }
              generateMovieCards(filteredMovies);
            })
            .catch((error) => console.error("Error fetching movies:", error));
        }

        function generateMovieCards(movies) {
          const movieContainer = document.getElementById("movieContainer");

          movieContainer.innerHTML = "";

          if (movies.length === 0) {
            let content = `
                  <div class="no-movies">
                      <h2>No movies found.</h2>
                  </div>
                `;
            movieContainer.innerHTML = content;
          } else {
            movies.forEach((movie) => {
              const card = `
                    <a href="https://krisnasantosa15.github.io/sineflix/pages/detailFilm.html?id=${
                      movie.id
                    }">
                    <div class="cards">
                        <div class="card-img">
                            <img src="${movie.img}" alt="${movie.title}">
                            <div class="img-title">
                                <h4>${movie.rating}</h4>
                                <p>IMDb</p>
                            </div>
                        </div>
                        <div class="card-title">
                            <h3>${movie.title}</h3>
                            <p>${movie.genre.join(", ")}</p>
                        </div>
                    </div>
                    </a>
                  `;
              movieContainer.insertAdjacentHTML("beforeend", card);
            });
          }
        }
      });

      // Fetch data from data.json
      fetch("https://krisnasantosa15.github.io/sineflix/js/data/data.json")
        .then((response) => response.json())
        .then((data) => {
          const heroSection = document.getElementById("heroSection");
          let number = 1;

          // Filter out only the items with type "HeroSection"
          const heroSectionItems = data.items.filter(
            (item) => item.type === "HeroSection"
          );

          // Loop through each item in the filtered data
          heroSectionItems.forEach((item) => {
            // Create a swiper-slide element
            const swiperSlide = document.createElement("div");
            swiperSlide.classList.add("swiper-slide", `slide-${number++}`);

            // Construct HTML structure dynamically based on item data
            swiperSlide.innerHTML = `
    <div class="swiper-container">
      <div class="type">
        ${item.genre
          .map((genre) => `<p>${genre}</p><div class="line"></div>`)
          .join("")}
      </div>
      <div class="movie-title">
        <h2>${item.title}</h2>
        <p>${item.description}</p>
      </div>
      <div class="movie-rating">
        <div>
          <p>IMDb: ${item.rating}</p>
        </div>
        <div>
          <p>${item.time}</p>
        </div>
        <div class="rect">
          <p>${item.age}</p>
        </div>
      </div>
      <div class="movie-btn">
        <button class="btn-1">
          <i class="fa-regular fa-play-circle"></i> Watch Trailer
        </button>
        ${
          localStorage.getItem("myList") &&
          JSON.parse(localStorage.getItem("myList")).find(
            (itemL) => itemL === item.id
          )
            ? `<button class="btn-1"><i class="fa-regular fa-bookmark"></i> Remove from My List</button>`
            : `<button class="btn-2" id="addToListButton" onclick="addToList('${item.id}')"><i class="fa-regular fa-bookmark"></i> Add to My List</button>`
        }
      </div>
    </div>
  `;

            // Append the constructed swiper-slide to heroSection
            heroSection.appendChild(swiperSlide);
          });

          // Initialize Swiper after data population
          const swiper = new Swiper(".swiper-container", {
            // Add Swiper options here
            loop: true,
            pagination: {
              el: ".swiper-pagination",
              clickable: true,
            },
          });
        })
        .catch((error) => console.error("Error fetching data:", error));
    </script>
  </body>
</html>
